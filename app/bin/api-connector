#!/usr/bin/env ruby
require_relative '../config/defaults'

Thread.abort_on_exception = true

$logger.info 'Initializing Kubernetes Meter Submission Handler'

config = Inventory::load_configuration($logger)

connector = OnPremiseConnector.new(config)

loop {
  connector.sync
  File.write("/tmp/heartbeat", "")  # for kubernetes health check
  sleep 1.second }
